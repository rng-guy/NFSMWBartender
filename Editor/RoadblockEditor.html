<!-- 
    HERE BE DRAGONS: Genuinely the WORST thing I've ever dared publish.

    I'd rather spend my time reversing game mechanics than refreshing my rusty
    JavaScript knowledge for a one-off tool, so I used Gemini to draft this thing.
    Nonetheless, it still took me hours of manual testing and un-fucking of the styling
    to get this to work as I had envisioned it. I might just rewrite it should I ever get
    around to it, because I low-key loathe myself for having used generative AI for ANYTHING.

    After experiencing the "joys" of "vibecoding" (I hate that word SO much) for myself, 
    let me offer you a small piece of advice: Do NOT use generative AI for anything more
    complicated than basic HTML, CSS, and JS. While functional, this tool is still an 
    unmaintainable, div-laden mess that nobody should EVER attempt to refactor by hand. 
    I cannot even begin to imagine how annoying it would be to unfuck AI-generated C++
    or, god forbid, ASM by hand. My condolences to anyone whose employer mandates AI use.
-->

<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Roadblock Editor</title>

    <link rel="icon" type="image/x-icon" href="Assets/Images/Icon.ico">

    <style>
      body {
	      background-color: #D9D9DB; 
	      font-family:      sans-serif;
	      display:          flex;
	      flex-direction:   column;
	      align-items:      center;
	      gap:              20px;
	      padding:          20px;
      }
      
      .error-pane {
	      font-size:   40px;
	      font-weight: bold;
	      margin-top:  100px;
      }

      .workspace, .modal-overlay { display: none; }
    </style>
    
    <link rel="stylesheet" href="Assets/Source/Styles.css">
    <script src="Assets/Source/Scripting.js" defer></script>
  </head>

  <body>
    <div class="error-pane" id="error">
      <p>Enable <span style="color: #D61E00">JavaScript</span> in order to use this tool.</p>
      <p>Ensure Bartender's <span style="color: #D61E00">Assets</span> folder is present.</p>
    </div>
    
    <div class="workspace" id="main">
      <div class="canvas-container">
        <div class="caption">Roadblock</div>
        <div id="canvasCounter">Room for 5 more part(s)</div>
        <div id="canvasOverlay">Left-click to select. Scroll to rotate. Hold Shift to snap.</div>
        <canvas id="mainCanvas" width="700" height="450" tabindex="0"></canvas>
      </div>

      <div class="bottom-controls">
        <div class="btn-group-left">
          <button id="btnCar" class="btn-add" onclick="handleAction('car')">✚ car</button>
          <button id="btnSpikes" class="btn-add" onclick="handleAction('spikes')">✚ spikes</button>
          <button id="btnBarricade" class="btn-add" onclick="handleAction('barricade')">✚ barricade</button>
          <button id="btnImport" class="btn-misc" onclick="openImportModal()">import</button>
        </div>
        <div class="btn-group-right">
          <button id="deleteBtn" class="btn-misc" onclick="deleteSelected()" disabled>remove selected</button>
          <button id="btnClear" class="btn-misc" onclick="clearCanvas()">clear</button>
        </div>
      </div>

      <div class="output-container">
        <div class="caption">Bartender settings</div>
        <div class="output-wrapper">
          <div id="outputField"></div>
          <div id="outputOverlay">Click to copy settings.</div>
        </div>
      </div>
    </div>

    <div id="importModal" class="modal-overlay">
      <div class="modal-content">
        <div class="modal-header">
          Import from Bartender
        </div>
        <textarea id="importInput" class="modal-textarea" placeholder="part01 = typeID, {horizontal, vertical}Offset, orientation
								       part02 = typeID, ...





								       (roadblocks not from this editor may end up slightly misaligned)"></textarea>
        <div class="modal-footer">
          <button id="btnLoadImport" onclick="loadImportData()" disabled>apply</button>
	      <button onclick="closeImportModal()">cancel</button>
        </div>
      </div>
    </div>
  </body>

</html>
